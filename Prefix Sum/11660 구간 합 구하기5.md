tags: `BOJ`, `Prefix Sum`
# [BOJ] 11660번 구간 합 구하기5 (PYTHON)
백준온라인저지(BOJ) https://www.acmicpc.net/

ID: yuchem2

Date: 2023.05.17
## 1. 문제설명
| 시간 제한 | 메모리 제한 | 제출  | 정답 | 맞은 사람 | 정답 비율 |
| :---: | :---: | :---: | :---: | :---: | :---: |
|  1초  | 256 MB | 45304 | 20840 | 15944 | 45.043% |

### 문제
---
N×N개의 수가 N×N 크기의 표에 채워져 있다. (x1, y1)부터 (x2, y2)까지 합을 구하는 프로그램을 작성하시오. (x, y)는 x행 y열을 의미한다.

예를 들어, N = 4이고, 표가 아래와 같이 채워져 있는 경우를 살펴보자.

여기서 (2, 2)부터 (3, 4)까지 합을 구하면 3+4+5+4+5+6 = 27이고, (4, 4)부터 (4, 4)까지 합을 구하면 7이다.

|   1   |   2   |   3   |   4   |
| :---: | :---: | :---: | :---: |
|   2   |   3   |   4   |   5   |
|   3   |   4   |   5   |   6   |
|   4   |   5   |   6   |   7   |

표에 채워져 있는 수와 합을 구하는 연산이 주어졌을 때, 이를 처리하는 프로그램을 작성하시오.
### 입력
---
첫째 줄에 표의 크기 N과 합을 구해야 하는 횟수 M이 주어진다. (1 ≤ N ≤ 1024, 1 ≤ M ≤ 100,000) 둘째 줄부터 N개의 줄에는 표에 채워져 있는 수가 1행부터 차례대로 주어진다. 다음 M개의 줄에는 네 개의 정수 x1, y1, x2, y2 가 주어지며, (x1, y1)부터 (x2, y2)의 합을 구해 출력해야 한다. 표에 채워져 있는 수는 1,000보다 작거나 같은 자연수이다. (x1 ≤ x2, y1 ≤ y2)
### 출력
---
총 M줄에 걸쳐 (x1, y1)부터 (x2, y2)까지 합을 구해 출력한다.
### 예제입력1
```
4 3
1 2 3 4
2 3 4 5
3 4 5 6
4 5 6 7
2 2 3 4
3 4 3 4
1 1 4 4
```
### 예제출력1
```
27
6
64
```
## 2. 소스코드

### 알고리즘
2차원 배열에 누적합을 구한 뒤 이를 이용해 특정 구간의 합을 구하는 방법이다.  

|   0   |   1   |   2   |   3   |
| :---: | :---: | :---: | :---: |
|   1   |   2   |   3   |   4   |
|   2   |   3   |   4   |   5   |
|   3   |   4   |   5   |   6   |
|   4   |   5   |   6   |   7   |

위와 같은 배열이 있을 때 (2, 2)부터 (3, 4) 까지의 합을 구한다고 해보자. 이 구간만 따로 빼서 생각하면 아래표와 같다.  
이 구간의 합을 구하기 위해서는 단순히 이 구간의 갑을 구할 수도 있다. 하지만 모든 문제에 대해 이렇게 연산을 수행한다면 $O(N^2M)$이 소요될 수 있다. 

|   0   |   1   |   2   |
| :---: | :---: | :---: |
|   4   |   5   |   6   |
|   3   |   4   |   5   |

그래서 우리는 누적합을 이용해 이 구간을 계산한다. 1차원 배열처럼 행에 대해서만 누적합을 계산한다면 이는 올바른 누적합이라고 보기 힘들다.  
그러므로 행과 열 모두에 대해서 누적합을 구한다. 즉 배열을 a라고 한다면, 

$$a[i][j] = a[i-1][j] + a[i][j-1] - a[i-1][j-1]$$

로 구한다. 여기서 a[i-1][j-1]을 빼주는 이유는, a[i-1][j]와 a[i][j-1] 둘다 a[i-1][j-1] 값이 더해진 값이기 때문이다.  
이를 통해 표를 바꾸고, 코드로 연산하기 위해서 위와 좌측에만 paddding을 해주면 다음과 같은 배열이 만들어 진다. 

|  i\j  |   0   |   1   |   2   |   3   |   4   |
| :---: | :---: | :---: | :---: | :---: | :---: |
|   0   |   0   |   0   |   0   |   0   |   0   |
|   1   |   0   |   1   |   3   |   6   |  10   |
|   2   |   0   |   3   |   8   |   15  |  24   |
|   3   |   0   |   6   |  15   |   27  |  42   |
|   4   |   0   |  10   |  24   |   42  |  64   |

위 표에서 구간 ((x1, y1), (x2, y2))가 주어진 다면 구간의 합을 다음과 같이 정의할 수 있다.

$$ reuslt = a[x2][y2] - a[x2][y1-1] - a[x1-1][y2] + a[x1-1][y1-1]$$

이를 실제로 구간 ((2, 2), (3, 4))에 적용한다면 result는 다음과 같다.

$$ result = a[3][4] - a[3][1] - a[1][4] + a[1][1] = 42 - 6 - 10 + 1 = 27 $$

이는 $ 3 + 4 + 5 + 4 + 5 +6 = 27$과 같다. 

### 코드
```Python
import sys

features, num = map(int, input().split())
array = [0]*(features+1)
array[0] = [0]*(features+1)
for i in range(features):
    array[i+1] = list(map(int, sys.stdin.readline().split()))
    array[i+1].insert(0, 0)

for i in range(1, features+1):
    for j in range(1, features+1):
        array[i][j] += (array[i-1][j] + array[i][j-1]-array[i-1][j-1])

for i in range(num):
    x1, y1, x2, y2 = map(int, sys.stdin.readline().split())
    result = array[x2][y2] - array[x2][y1-1] - array[x1-1][y2] + array[x1-1][y1-1]
    sys.stdout.write(str(result)+"\n")
```

| 결과 | 메모리 | 시간 | 코드길이 |
|:---:|:-----: | :---: | :----: |
| 맞았습니다 | 73076 KB | 984ms | 564B |

## 3. 개선점
x
## 4. 개선사항
x
## 5. 개선사항 평가
x
